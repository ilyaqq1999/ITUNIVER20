@using ItUniver.Tasks.Web.Models
@model TaskCreateModel

@{
    const string formId = "task_create_form";
}

<div class="card">
    <div class="card-header">
        Создание задачи
    </div>
    <div class="card-body">
        <form id="@formId">
            <div class="form-group">
                @Html.LabelFor(model => model.Subject, "Задача")
                @Html.TextBoxFor(model => model.Subject, string.Empty, new { @class = "form-control", @placeholder = "Введите задачу" })
                @Html.ValidationMessageFor(model => model.Subject)
            </div>
            <div class="form-group">
                @Html.LabelFor(model => model.Description, "Описание")
                @Html.TextAreaFor(model => model.Description, new { @class = "form-control", @placeholder = "Введите описание задачи" })
            </div>

            <input type="button" class="btn btn-success" value="Сохранить" onclick="save('@(formId)')">
            <a class="btn btn-danger" href="@Url.Action("Index", "Task")">Отмена</a>
        </form>
    </div>
</div>

<script type="text/javascript">
    function save(formId) {
        //debugger;
        var postData = objectifyForm(formId);
        $.ajax({
            url: "/api/services/task/create",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            method: "POST",
            data: JSON.stringify(postData),
            success: function () {
                window.location.href = "/Task/Index";
            }
        });
    }
</script>

@section scripts
{
    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
}